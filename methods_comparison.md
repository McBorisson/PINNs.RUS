# Постановка задачи  
Рассматривается нелинейное уравнение Шрёдингера:
$$i q_{t} + q_{xx} +q\cdot |q|^2(1-\alpha|q|^2+\beta |q|^4)=0$$
С начальным условием:
$$q(x,0) = \sqrt{\frac{\mu e^{\left(x - x_{0}\right) \sqrt{\mu}}}{\left(\frac{1}{2} e^{\left(x - x_{0}\right) \sqrt{\mu}} + 1\right)^{2} - \frac{\alpha_0 \mu}{3} e^{2 \left(x - x_{0}\right) \sqrt{\mu}}}} e^{i \left(k x + \theta_{0}\right)},$$
$$где\ \mu = 4(k^{2} - w)$$
И граничным условием:
$$q(x_0,t)=q(x_1,t)=0$$
Аналитическое решение такой задачи известно:
$$q(x,t) = \sqrt{\frac{\mu e^{\left(x - 2 k t - x_{0}\right) \sqrt{\mu}}}{\left(\frac{1}{2} e^{\left(x - 2 k t - x_{0}\right) \sqrt{\mu}} + 1\right)^{2} - \frac{\alpha_0 \mu}{3} e^{2 \left(x - 2 k t - x_{0}\right) \sqrt{\mu}}}} e^{i \left(k x - \omega t + \theta_{0}\right)},$$
$$где\ \mu = 4(k^{2} - w)$$
Значения коэффициентов:  
$$k=1,\ w=0.88,\ x_0=-30,\ \theta_0=0,\ \alpha_0=0.3,\ \alpha=0.3,\ \beta=0$$
Рассматриваемая область:
$$x \in [-50,50],\ t \in [0,10]$$
Физический смысл уравнения - описание распостранения электромагнитных волн в нелинейных средах. Физический смысл начального условия - волна в виде солитона, то есть структурно устойчивая уединённая волна.  
В данной работе исследуются и сравниваются различные методы решения данной задачи, оценивается точность решения и время его нахождения.  
# Методы решения  
## Явная разностная схема
Исходное уравнение представляется в виде:
$$i\cdot \frac{q_{n+1,k}-q_{n,k}}{\Delta t} + \frac{q_{n,k+1}-2q_{n,k}+q_{n,k-1}}{(\Delta x)^2} + q_{n,k}\cdot |q_{n,k}|^2(1-\alpha|q_{n,k}|^2+\beta |q_{n,k}|^4)=0$$
Что позволяет найти явное выражение для последующего значения функции при известных предыдущих:
$$q_{n+1,k} = q_{n,k} + i \cdot \Delta t (\frac{q_{n,k+1}-2q_{n,k}+q_{n,k-1}}{(\Delta x)^2} + q_{n,k}\cdot |q_{n,k}|^2(1-\alpha|q_{n,k}|^2+\beta |q_{n,k}|^4))$$
При этом данная схема неустойчива:  
<img src="https://github.com/mikhakuv/PINNs/blob/main/pictures/explicit_scheme_stability.png">  

(В отличие от неявной схемы
$$i\cdot \frac{q_{n+1,k}-q_{n,k}}{\Delta t} + \frac{q_{n+1,k+1}-2q_{n+1,k}+q_{n+1,k-1}}{(\Delta x)^2} + q_{n,k}\cdot |q_{n,k}|^2(1-\alpha|q_{n,k}|^2+\beta |q_{n,k}|^4)=0,$$
которая устойчива:  
<img src="https://github.com/mikhakuv/PINNs/blob/main/pictures/implicit_scheme_stability.png">)  

Реализация явной схемы даёт следующие результаты:  
$Time: 14s &emsp; MSE_q: 2.132\cdot 10^{-4} &emsp; Rel_h: 1.070\cdot 10^{-1}$  
<img src="https://github.com/mikhakuv/PINNs/blob/main/pictures/explicit_scheme_results.png">  

## Метод PINNs
Метод основан на идее нахождения решения в виде нейросети и сведения задачи решения дифференциального уравнения к задаче подбора правильных параметров - весов и смещений внутри нейросети.
<img src="https://github.com/mikhakuv/PINNs_Loss_Balancing/blob/main/pictures/illustration.png">  

Реализация данного метода даёт следующие результаты:  
$Time: 11min 55s &emsp; MSE_q: 1.499\cdot 10^{-6} &emsp; Rel_h: 8.122\cdot 10^{-3}$  
<img src="https://github.com/mikhakuv/PINNs/blob/main/pictures/neural_network_results.png">  

## Дополнительно: Метод итерации
Данный метод основан на поиске решения в виде: $q(x,t)=\sum\limits_{k=1}^{K} \psi_k(x)\ T_k(t)$, где $\psi_k(x)$ - решение задачи $\frac{d^2 \psi_k}{d x^2}=\lambda_k\ \psi_k, &ensp; \psi_k(x_0)=\psi_k(x_1)=0$;  
$T_k$ - решение задачи $i\ \frac{d T_k}{d t} + \lambda_k\ T_k + M_k = 0, &ensp; T_k(0)=\alpha_k$  
В теории это сводит решение уравнения Шрёдингера к последовательному вычислению интегралов потому что у записанных уравнений решения легко определяются аналитически.  
Реализация данной идеи даёт следующие результаты:  
$Time: 1min 17s &emsp; MSE_q: 2.192\cdot 10^{-1} &emsp; Rel_h: 4.946$  
<img src="https://github.com/mikhakuv/PINNs/blob/main/pictures/iteration_method_results.png">  

Видно, что с увеличением $t$ растёт и амплитуда побочных колебаний. Предполагается, что они вызваны аппроксимацией начального условия, оставляющей небольшие волны, которые потом перерастают в заметные возмущения. 
Тем не менее, работа с данным методом ещё не окончена и возможно эта проблема будет решена в дальнейшем.  
# Результаты  
В данной работе рассмотрено и реализовано несколько методов численного решения нелинейного уравнения Шрёдингера. Метод PINNs показал наилучшие реpультаты по точности и за счёт возможности использования графических ускорителей не сильно отстал по скорости.  
Остальные методы имеют высокую ошибку при больших значениях $t$ и требуют усовершенстования: использования неявной схемы в случае с разностной схемой и изменения алгоритма в случае с методом итераций.
